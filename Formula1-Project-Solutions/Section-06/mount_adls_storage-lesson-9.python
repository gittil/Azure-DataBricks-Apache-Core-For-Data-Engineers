{"version":"NotebookV1","origId":4277921907349033,"name":"mount_adls_storage-lesson-9","language":"python","commands":[{"version":"CommandV1","origId":4277921907349034,"guid":"d1c4e3f7-3ab2-4556-83b7-ab2359bff7dc","subtype":"command","commandType":"auto","position":1.0,"command":"storage_account_name = \"formula1dl\"\nclient_id            = dbutils.secrets.get(scope=\"formula1-scope\", key=\"databricks-app-client-id\")\ntenant_id            = dbutils.secrets.get(scope=\"formula1-scope\", key=\"databricks-app-tenant-id\")\nclient_secret        = dbutils.secrets.get(scope=\"formula1-scope\", key=\"databricks-app-client-secret\")","commandVersion":24,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"19734d81-6f0d-4291-a46f-088dc2120fb2"},{"version":"CommandV1","origId":4277921907349035,"guid":"b5d3af21-81be-44d9-944d-1cd6f5695892","subtype":"command","commandType":"auto","position":2.0,"command":"configs = {\"fs.azure.account.auth.type\": \"OAuth\",\n           \"fs.azure.account.oauth.provider.type\": \"org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider\",\n           \"fs.azure.account.oauth2.client.id\": f\"{client_id}\",\n           \"fs.azure.account.oauth2.client.secret\": f\"{client_secret}\",\n           \"fs.azure.account.oauth2.client.endpoint\": f\"https://login.microsoftonline.com/{tenant_id}/oauth2/token\"}","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"43371743-792c-46f6-933d-9bd136232b56"},{"version":"CommandV1","origId":4277921907349036,"guid":"2979f35f-da03-4a2a-a4fa-9998f5834951","subtype":"command","commandType":"auto","position":7.0,"command":"def mount_adls(container_name):\n  dbutils.fs.mount(\n    source = f\"abfss://{container_name}@{storage_account_name}.dfs.core.windows.net/\",\n    mount_point = f\"/mnt/{storage_account_name}/{container_name}\",\n    extra_configs = configs)","commandVersion":19,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5b4c7d8b-de66-49b5-94cf-aa4aa20c32ee"},{"version":"CommandV1","origId":4277921907349037,"guid":"54d7b5f7-e7e2-495b-899e-ed89dee68280","subtype":"command","commandType":"auto","position":7.5,"command":"mount_adls(\"raw\")","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c503e2b9-3aac-453f-8a11-67b9856df896"},{"version":"CommandV1","origId":4277921907349038,"guid":"c0c02363-9911-42fa-95b9-e273a658a9c7","subtype":"command","commandType":"auto","position":8.0,"command":"mount_adls(\"processed\")","commandVersion":5,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5d6b5750-e130-4765-9b0e-f2200db36a75"},{"version":"CommandV1","origId":4277921907349039,"guid":"c1b4577b-d5ae-4b24-b6fa-72c57e81cc8a","subtype":"command","commandType":"auto","position":8.5,"command":"dbutils.fs.ls(\"/mnt/formula1dl/raw\")","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8afc5168-2db7-4a73-a764-dbf44b5d6d6a"},{"version":"CommandV1","origId":4277921907349040,"guid":"91083d40-667e-4575-9ebf-2665041d7752","subtype":"command","commandType":"auto","position":9.0,"command":"dbutils.fs.ls(\"/mnt/formula1dl/processed\")","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b0188e12-f0a5-42aa-87f9-5165a0b2c9f6"},{"version":"CommandV1","origId":4277921907349041,"guid":"359feefd-5865-45fc-94c8-e1ce3a990c06","subtype":"command","commandType":"auto","position":12.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0b18871b-54de-424c-a86f-7e76587bd941"}],"dashboards":[],"guid":"b13a1af5-eb4e-43ce-9a93-2ca89570f853","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}
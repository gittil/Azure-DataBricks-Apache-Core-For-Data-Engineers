{"version":"NotebookV1","origId":4277921907349379,"name":"4.viz_dominant_teams","language":"sql","commands":[{"version":"CommandV1","origId":4277921907349380,"guid":"6790d486-20c9-4b58-855b-5cfe45c63a95","subtype":"command","commandType":"auto","position":1.5,"command":"%python\nhtml = \"\"\"<h1 style=\"color:Black;text-align:center;font-family:Ariel\">Report on Dominant Formula 1 Teams </h1>\"\"\"\ndisplayHTML(html)","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f5fc7888-93d1-4cf3-b9a0-2509147cf52e"},{"version":"CommandV1","origId":4277921907349381,"guid":"3bf0f0b9-7b67-4869-ae02-88e99ca69706","subtype":"command","commandType":"auto","position":3.0,"command":"CREATE OR REPLACE TEMP VIEW v_dominant_teams\nAS\nSELECT team_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points,\n       RANK() OVER(ORDER BY AVG(calculated_points) DESC) team_rank\n  FROM f1_presentation.calculated_race_results\nGROUP BY team_name\nHAVING COUNT(1) >= 100\nORDER BY avg_points DESC","commandVersion":69,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"707","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d09b44f1-0570-489d-a4bb-aee2b47fa29b"},{"version":"CommandV1","origId":4277921907349382,"guid":"821429c5-5a01-4ab9-959b-7742fc275fc3","subtype":"command","commandType":"auto","position":3.5,"command":"SELECT * FROM v_dominant_teams;","commandVersion":5,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"657","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"27a5fee4-33e4-468a-8183-f6ed031c6808"},{"version":"CommandV1","origId":4277921907349383,"guid":"53feeb2c-de1b-4f7c-a804-b01dc7b2e7ce","subtype":"command","commandType":"auto","position":4.0,"command":"SELECT race_year, \n       team_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points\n  FROM f1_presentation.calculated_race_results\n WHERE team_name IN (SELECT team_name FROM v_dominant_teams WHERE team_rank <= 5)\nGROUP BY race_year, team_name\nORDER BY race_year, avg_points DESC","commandVersion":40,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"plotlyLine","width":"660","height":"auto","xColumns":["race_year"],"yColumns":["avg_points"],"pivotColumns":["team_name"],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"plotlyLine":[{"key":"yRange","value":""},{"key":"showPoints","value":false},{"key":"logScale","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ebae419c-35e9-44dd-8d7d-46c60622c949"},{"version":"CommandV1","origId":4277921907349384,"guid":"518e4179-1e0f-4114-900b-c88967c6dbc4","subtype":"command","commandType":"auto","position":6.0,"command":"SELECT race_year, \n       team_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points\n  FROM f1_presentation.calculated_race_results\n WHERE team_name IN (SELECT team_name FROM v_dominant_teams WHERE team_rank <= 5)\nGROUP BY race_year, team_name\nORDER BY race_year, avg_points DESC","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"areaChart","width":"660","height":"auto","xColumns":["race_year"],"yColumns":["avg_points"],"pivotColumns":["team_name"],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c0dae90a-8e4e-47e9-a12c-d7cfa8277aa0"},{"version":"CommandV1","origId":4277921907349385,"guid":"8fad2425-63b7-48e9-a0e1-3a92eca42ca3","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9bd1dfaf-2e3c-4941-ba7a-79dc30556f9f"}],"dashboards":[{"version":"DashboardViewV1","origId":4277921907349386,"guid":"93b502e4-5e28-4462-a026-cb707ee50d0a","nuid":"781a7c2b-cd58-4356-a20f-5d7936debbab","title":"F1 Dominant Teams","width":1024,"layoutOption":{"stack":true,"grid":true},"elements":[{"guid":"1b3a5298-8aaf-4e57-b371-1a2e9ff4586d","elementType":"command","elementNUID":"c0dae90a-8e4e-47e9-a12c-d7cfa8277aa0","position":{"width":12,"height":9,"x":12,"y":2,"z":null},"options":{"showTitle":true,"scale":0,"autoScaleImg":false,"title":"Dominant Teams","titleAlign":"center"}},{"guid":"585bbb8f-25e7-4d07-be79-48b1eb7aeaaa","elementType":"command","elementNUID":"ebae419c-35e9-44dd-8d7d-46c60622c949","position":{"width":12,"height":9,"x":0,"y":2,"z":null},"options":{"showTitle":true,"scale":0,"autoScaleImg":false,"title":"Dominant Teams","titleAlign":"center"}},{"guid":"f064656b-0e93-46c3-9e22-8d7180e1d660","elementType":"command","elementNUID":"f5fc7888-93d1-4cf3-b9a0-2509147cf52e","position":{"width":24,"height":2,"x":0,"y":0,"z":null},"options":null}],"globalVars":{}}],"guid":"23e7f08a-b08c-4ce0-b71b-1e0fbd01575a","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}
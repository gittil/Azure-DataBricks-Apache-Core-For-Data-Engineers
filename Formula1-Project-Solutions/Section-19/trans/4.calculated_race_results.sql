{"version":"NotebookV1","origId":4277921907349911,"name":"4.calculated_race_results","language":"sql","commands":[{"version":"CommandV1","origId":4277921907349912,"guid":"a0c3198c-f883-44aa-8597-0bbd78376726","subtype":"command","commandType":"auto","position":2.0,"command":"USE f1_processed;","commandVersion":4,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"22d73055-98e8-4ec6-8afb-2161c2229045"},{"version":"CommandV1","origId":4277921907349913,"guid":"76d9fd6b-add9-4327-a455-d0aefe608c78","subtype":"command","commandType":"auto","position":3.0,"command":"CREATE TABLE f1_presentation.calculated_race_results\nUSING parquet\nAS\nSELECT races.race_year,\n       constructors.name AS team_name,\n       drivers.name AS driver_name,\n       results.position,\n       results.points,\n       11 - results.position AS calculated_points\n  FROM results \n  JOIN f1_processed.drivers ON (results.driver_id = drivers.driver_id)\n  JOIN f1_processed.constructors ON (results.constructor_id = constructors.constructor_id)\n  JOIN f1_processed.races ON (results.race_id = races.race_id)\n WHERE results.position <= 10","commandVersion":160,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"778","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8349f93d-13da-4bcd-bffe-c38017a6751a"},{"version":"CommandV1","origId":4277921907349914,"guid":"0b17e5d2-9b87-4cd1-8256-1be65ad81ba5","subtype":"command","commandType":"auto","position":4.0,"command":"SELECT * FROM f1_presentation.calculated_race_results","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"855","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"780bf70d-c134-41aa-889b-98ede2cc0d7c"},{"version":"CommandV1","origId":4277921907349915,"guid":"be8c66bb-3cc8-4fa1-bf31-a1c5eb41f70c","subtype":"command","commandType":"auto","position":5.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e7ea82c7-2159-420d-8c35-301c6b6da574"}],"dashboards":[],"guid":"0433f0a2-2e4e-4553-abfc-d8dd34deba74","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}
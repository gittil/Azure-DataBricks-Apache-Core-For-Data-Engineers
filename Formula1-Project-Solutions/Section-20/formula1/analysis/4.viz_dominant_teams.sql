{"version":"NotebookV1","origId":4277921907349927,"name":"4.viz_dominant_teams","language":"sql","commands":[{"version":"CommandV1","origId":4277921907349928,"guid":"c0d66f30-5f7b-4af8-98a1-fa7fb112b339","subtype":"command","commandType":"auto","position":1.5,"command":"%python\nhtml = \"\"\"<h1 style=\"color:Black;text-align:center;font-family:Ariel\">Dominant Formula 1 Teams of All Time</h1>\"\"\"\ndisplayHTML(html)","commandVersion":7,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f5fc7888-93d1-4cf3-b9a0-2509147cf52e"},{"version":"CommandV1","origId":4277921907349929,"guid":"a29411fe-b841-4a9c-8b31-ce73a7cfdfb3","subtype":"command","commandType":"auto","position":3.0,"command":"CREATE OR REPLACE TEMP VIEW v_dominant_teams\nAS\nSELECT team_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points,\n       RANK() OVER(ORDER BY AVG(calculated_points) DESC) team_rank\n  FROM f1_presentation.calculated_race_results\nGROUP BY team_name\nHAVING COUNT(1) >= 100\nORDER BY avg_points DESC","commandVersion":69,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"707","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d09b44f1-0570-489d-a4bb-aee2b47fa29b"},{"version":"CommandV1","origId":4277921907349930,"guid":"20b45045-ffd4-455e-accd-ce1df2258c01","subtype":"command","commandType":"auto","position":3.5,"command":"SELECT * FROM v_dominant_teams;","commandVersion":5,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"657","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"27a5fee4-33e4-468a-8183-f6ed031c6808"},{"version":"CommandV1","origId":4277921907349931,"guid":"df26f6b5-79f2-4932-81ea-e39f7a62fde2","subtype":"command","commandType":"auto","position":4.0,"command":"SELECT race_year, \n       team_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points\n  FROM f1_presentation.calculated_race_results\n WHERE team_name IN (SELECT team_name FROM v_dominant_teams WHERE team_rank <= 5)\nGROUP BY race_year, team_name\nORDER BY race_year, avg_points DESC","commandVersion":40,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"plotlyLine","width":"660","height":"auto","xColumns":["race_year"],"yColumns":["avg_points"],"pivotColumns":["team_name"],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"plotlyLine":[{"key":"yRange","value":""},{"key":"showPoints","value":false},{"key":"logScale","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ebae419c-35e9-44dd-8d7d-46c60622c949"},{"version":"CommandV1","origId":4277921907349932,"guid":"b97f6101-cd53-4d3b-b31d-428a0d4b49b7","subtype":"command","commandType":"auto","position":6.0,"command":"SELECT race_year, \n       team_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points\n  FROM f1_presentation.calculated_race_results\n WHERE team_name IN (SELECT team_name FROM v_dominant_teams WHERE team_rank <= 5)\nGROUP BY race_year, team_name\nORDER BY race_year, avg_points DESC","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"areaChart","width":"660","height":"auto","xColumns":["race_year"],"yColumns":["avg_points"],"pivotColumns":["team_name"],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c0dae90a-8e4e-47e9-a12c-d7cfa8277aa0"},{"version":"CommandV1","origId":4277921907349933,"guid":"2ab6a7f7-ad1b-4e02-aa20-f6c20437fabd","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9bd1dfaf-2e3c-4941-ba7a-79dc30556f9f"}],"dashboards":[{"version":"DashboardViewV1","origId":4277921907349934,"guid":"2559007b-87f5-4445-8fba-ba9fed41802e","nuid":"781a7c2b-cd58-4356-a20f-5d7936debbab","title":"F1 Dominant Teams","width":1024,"layoutOption":{"stack":true,"grid":true},"elements":[{"guid":"1b3a5298-8aaf-4e57-b371-1a2e9ff4586d","elementType":"command","elementNUID":"c0dae90a-8e4e-47e9-a12c-d7cfa8277aa0","position":{"width":12,"height":9,"x":12,"y":2,"z":null},"options":{"showTitle":true,"scale":0,"autoScaleImg":false,"title":"Dominant Teams","titleAlign":"center"}},{"guid":"585bbb8f-25e7-4d07-be79-48b1eb7aeaaa","elementType":"command","elementNUID":"ebae419c-35e9-44dd-8d7d-46c60622c949","position":{"width":12,"height":9,"x":0,"y":2,"z":null},"options":{"showTitle":true,"scale":0,"autoScaleImg":false,"title":"Dominant Teams","titleAlign":"center"}},{"guid":"f064656b-0e93-46c3-9e22-8d7180e1d660","elementType":"command","elementNUID":"f5fc7888-93d1-4cf3-b9a0-2509147cf52e","position":{"width":24,"height":2,"x":0,"y":0,"z":null},"options":null}],"globalVars":{}}],"guid":"28bbed61-8e90-45a7-a826-348bfb39190f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}
{"version":"NotebookV1","origId":4277921907350463,"name":"10.delta_lake_demo","language":"python","commands":[{"version":"CommandV1","origId":4277921907350464,"guid":"ad75ba3a-4a16-459b-a875-d5abfba307ff","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n1. Write data to delta lake (managed table)\n2. Write data to delta lake (external table)\n3. Read data from delta lake (Table)\n4. Read data from delta lake (File)","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c22be0a6-3dd3-460d-97d5-997e6a504dd5"},{"version":"CommandV1","origId":4277921907350465,"guid":"4d8559e9-982b-4a93-9969-c7d8b1da5334","subtype":"command","commandType":"auto","position":2.0,"command":"%sql\nCREATE DATABASE IF NOT EXISTS f1_demo\nLOCATION '/mnt/formula1dl/demo'","commandVersion":23,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b9852dc7-24a0-4f24-b258-774383a7d151"},{"version":"CommandV1","origId":4277921907350466,"guid":"b85593c9-efd2-45bf-a02b-891e2a12d7da","subtype":"command","commandType":"auto","position":5.0,"command":"results_df = spark.read \\\n.option(\"inferSchema\", True) \\\n.json(\"/mnt/formula1dl/raw/2021-03-28/results.json\")","commandVersion":34,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ee5e037a-baa8-4aec-93e5-79453d8aa65f"},{"version":"CommandV1","origId":4277921907350467,"guid":"8e0ae493-0a17-423f-ade7-542178829d2b","subtype":"command","commandType":"auto","position":6.0,"command":"results_df.write.format(\"delta\").mode(\"overwrite\").saveAsTable(\"f1_demo.results_managed\")","commandVersion":8,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7eb39bb1-f3c5-4de8-b1c5-08bb2c0a4650"},{"version":"CommandV1","origId":4277921907350468,"guid":"c61b6b03-f6f8-440f-8f01-ca1575943ed2","subtype":"command","commandType":"auto","position":7.0,"command":"%sql\nSELECT * FROM f1_demo.results_managed;","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"78f7e878-6c02-4f3d-8044-484a9cfabaeb"},{"version":"CommandV1","origId":4277921907350469,"guid":"0f11c18a-f3c1-45d4-9d0d-7ea27aab4ec2","subtype":"command","commandType":"auto","position":8.0,"command":"results_df.write.format(\"delta\").mode(\"overwrite\").save(\"/mnt/formula1dl/demo/results_external\")","commandVersion":8,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"98b11417-4bba-48c7-aa20-be3103f46c23"},{"version":"CommandV1","origId":4277921907350470,"guid":"967bc983-a252-4129-8d55-4471af841cc7","subtype":"command","commandType":"auto","position":9.0,"command":"%sql\nCREATE TABLE f1_demo.results_external\nUSING DELTA\nLOCATION '/mnt/formula1dl/demo/results_external'","commandVersion":27,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"021f5ba7-bf6f-4348-8c84-f8e44d018359"},{"version":"CommandV1","origId":4277921907350471,"guid":"72fa5496-9521-4b80-b9d8-dd1abb280c58","subtype":"command","commandType":"auto","position":10.0,"command":"%sql\nSELECT * FROM f1_demo.results_external","commandVersion":4,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2bc28e3e-de2f-4b6a-8448-6c89c56b3f70"},{"version":"CommandV1","origId":4277921907350472,"guid":"25740f6a-56c6-470f-8ecb-79f6fd97a270","subtype":"command","commandType":"auto","position":11.0,"command":"results_external_df = spark.read.format(\"delta\").load(\"/mnt/formula1dl/demo/results_external\")","commandVersion":18,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"92289cb6-7318-4c58-b867-2766db8c327b"},{"version":"CommandV1","origId":4277921907350473,"guid":"41eedc1f-ec5a-4e93-a0a2-28bc87c04e35","subtype":"command","commandType":"auto","position":12.0,"command":"display(results_external_df)","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"badb4324-09ec-49ff-967a-bfcee2a41004"},{"version":"CommandV1","origId":4277921907350474,"guid":"81be0906-75aa-46af-aef5-9a0094663b4e","subtype":"command","commandType":"auto","position":14.0,"command":"results_df.write.format(\"delta\").mode(\"overwrite\").partitionBy(\"constructorId\").saveAsTable(\"f1_demo.results_partitioned\")","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"32933710-5fd5-4e9b-9d92-81f82463eb2e"},{"version":"CommandV1","origId":4277921907350475,"guid":"ce7a3062-1072-4b02-8a03-83fb8507e57c","subtype":"command","commandType":"auto","position":15.0,"command":"%sql\nSHOW PARTITIONS f1_demo.results_partitioned","commandVersion":5,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"270","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c3268663-af95-45ff-9bbf-d665a646faca"},{"version":"CommandV1","origId":4277921907350476,"guid":"677839d6-e178-43de-8344-d5e047bdfbc7","subtype":"command","commandType":"auto","position":16.0,"command":"%md\n1. Update Delta Table\n2. Delete From Delta Table","commandVersion":17,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1c09007e-5497-4624-902f-04c8e01cf4d7"},{"version":"CommandV1","origId":4277921907350477,"guid":"525d7d18-3f3c-4d3a-a268-f46d36c2de53","subtype":"command","commandType":"auto","position":17.0,"command":"%sql\nSELECT * FROM f1_demo.results_managed;","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"435a554d-84f2-433d-a935-7463a3b0369d"},{"version":"CommandV1","origId":4277921907350478,"guid":"8a9e914b-5246-43af-8cd0-6bee32aafbc9","subtype":"command","commandType":"auto","position":18.0,"command":"%sql\nUPDATE f1_demo.results_managed\n  SET points = 11 - position\nWHERE position <= 10","commandVersion":30,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d0732c2b-3e09-4560-9c84-15565cd78760"},{"version":"CommandV1","origId":4277921907350479,"guid":"2e505170-14a5-482b-9843-680451471a2f","subtype":"command","commandType":"auto","position":19.0,"command":"%sql\nSELECT * FROM f1_demo.results_managed;","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"09b33930-e3fd-40b8-8535-97587d06648f"},{"version":"CommandV1","origId":4277921907350480,"guid":"edf46dd2-5cbf-4836-80f3-0211a80fb24e","subtype":"command","commandType":"auto","position":20.0,"command":"from delta.tables import DeltaTable\n\ndeltaTable = DeltaTable.forPath(spark, \"/mnt/formula1dl/demo/results_managed\")\n\ndeltaTable.update(\"position <= 10\", { \"points\": \"21 - position\" } ) ","commandVersion":17,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9c02bc97-9fdf-4da9-a201-7a4d14342805"},{"version":"CommandV1","origId":4277921907350481,"guid":"a9dc6e16-ecca-47f7-9c93-c2e634fb5491","subtype":"command","commandType":"auto","position":21.0,"command":"%sql\nSELECT * FROM f1_demo.results_managed;","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"90775170-902d-4ea7-b1ab-b2ce19c686e7"},{"version":"CommandV1","origId":4277921907350482,"guid":"8dcb6bf1-1bf6-42f6-8c08-17cf99b5cb68","subtype":"command","commandType":"auto","position":24.0,"command":"%sql\nDELETE FROM f1_demo.results_managed\nWHERE position > 10;","commandVersion":11,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"17ed7286-babe-46b2-8f7b-e949a172dc3b"},{"version":"CommandV1","origId":4277921907350483,"guid":"f31fd8db-0493-493a-80e2-428bcb821499","subtype":"command","commandType":"auto","position":25.0,"command":"%sql\nSELECT * FROM f1_demo.results_managed;","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e4a0ce38-4acc-4503-a1ef-d11053a3741c"},{"version":"CommandV1","origId":4277921907350484,"guid":"71203d54-2ed4-4f6f-be1a-5103d3e0ccc0","subtype":"command","commandType":"auto","position":26.0,"command":"from delta.tables import DeltaTable\n\ndeltaTable = DeltaTable.forPath(spark, \"/mnt/formula1dl/demo/results_managed\")\n\ndeltaTable.delete(\"points = 0\") ","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0567355c-d87d-485b-bab3-e0619ec8de37"},{"version":"CommandV1","origId":4277921907350485,"guid":"28bdcb5a-8953-4a87-ba0d-d45265f05e66","subtype":"command","commandType":"auto","position":27.0,"command":"%sql\nSELECT * FROM f1_demo.results_managed;","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2022","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4cfbb136-18f3-429e-b335-61cbf850979d"},{"version":"CommandV1","origId":4277921907350486,"guid":"d55e4e64-a627-403f-9f05-c414eb5aff37","subtype":"command","commandType":"auto","position":28.0,"command":"%md\nUpsert using merge","commandVersion":13,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9adae723-e0b8-4711-9453-918c45f246a1"},{"version":"CommandV1","origId":4277921907350487,"guid":"875d07ad-722b-4639-945f-ef9237d0ff98","subtype":"command","commandType":"auto","position":29.0,"command":"drivers_day1_df = spark.read \\\n.option(\"inferSchema\", True) \\\n.json(\"/mnt/formula1dl/raw/2021-03-28/drivers.json\") \\\n.filter(\"driverId <= 10\") \\\n.select(\"driverId\", \"dob\", \"name.forename\", \"name.surname\")","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d1c7099f-d877-4fac-9a57-1581f39abe22"},{"version":"CommandV1","origId":4277921907350488,"guid":"e2e0019b-4288-41ae-ab3a-4ced2824b683","subtype":"command","commandType":"auto","position":30.0,"command":"display(drivers_day1_df)","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"469","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"56abcb97-8310-4640-936f-711bde67da4d"},{"version":"CommandV1","origId":4277921907350489,"guid":"ddf813ec-ca67-4b1c-9ca5-8a41f0c050ea","subtype":"command","commandType":"auto","position":30.5,"command":"drivers_day1_df.createOrReplaceTempView(\"drivers_day1\")","commandVersion":11,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a69f63a1-326a-40c4-85a9-817722952db1"},{"version":"CommandV1","origId":4277921907350490,"guid":"089d1482-777f-4363-b5b8-9afb557f3a35","subtype":"command","commandType":"auto","position":31.0,"command":"from pyspark.sql.functions import upper\n\ndrivers_day2_df = spark.read \\\n.option(\"inferSchema\", True) \\\n.json(\"/mnt/formula1dl/raw/2021-03-28/drivers.json\") \\\n.filter(\"driverId BETWEEN 6 AND 15\") \\\n.select(\"driverId\", \"dob\", upper(\"name.forename\").alias(\"forename\"), upper(\"name.surname\").alias(\"surname\"))","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f7473218-e0e2-4a33-b11e-29590ebccb30"},{"version":"CommandV1","origId":4277921907350491,"guid":"2afae166-6a2e-4609-b7fc-6fbb327d9097","subtype":"command","commandType":"auto","position":31.5,"command":"drivers_day2_df.createOrReplaceTempView(\"drivers_day2\")","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2fbd2b8d-1c05-48b2-87f7-ba1a4cdfba78"},{"version":"CommandV1","origId":4277921907350492,"guid":"b12a933a-485e-46a6-9faa-d8a7d2708546","subtype":"command","commandType":"auto","position":32.0,"command":"display(drivers_day2_df)","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"476","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"042c8714-06e3-4e9b-9e8e-fb935a7ff84c"},{"version":"CommandV1","origId":4277921907350493,"guid":"b180dc14-ee8c-4f87-8ffb-fe79ef33d3d0","subtype":"command","commandType":"auto","position":34.0,"command":"from pyspark.sql.functions import upper\n\ndrivers_day3_df = spark.read \\\n.option(\"inferSchema\", True) \\\n.json(\"/mnt/formula1dl/raw/2021-03-28/drivers.json\") \\\n.filter(\"driverId BETWEEN 1 AND 5 OR driverId BETWEEN 16 AND 20\") \\\n.select(\"driverId\", \"dob\", upper(\"name.forename\").alias(\"forename\"), upper(\"name.surname\").alias(\"surname\"))","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b98a282c-4b61-40b3-8619-abddd80feceb"},{"version":"CommandV1","origId":4277921907350494,"guid":"0965bcde-0558-451a-b544-00142bee7fe9","subtype":"command","commandType":"auto","position":35.0,"command":"%sql\nCREATE TABLE IF NOT EXISTS f1_demo.drivers_merge (\ndriverId INT,\ndob DATE,\nforename STRING, \nsurname STRING,\ncreatedDate DATE, \nupdatedDate DATE\n)\nUSING DELTA","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a8de9fb3-27e1-4d68-8b20-cf35e58f10a5"},{"version":"CommandV1","origId":4277921907350495,"guid":"e414053c-59d1-412e-9b94-1f1703ac8ca2","subtype":"command","commandType":"auto","position":35.5,"command":"%md Day1","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b92d6135-c66a-47bf-acde-14c0af08fa30"},{"version":"CommandV1","origId":4277921907350496,"guid":"3f24742f-8b17-4a24-97a3-9e4ed502a9e8","subtype":"command","commandType":"auto","position":36.0,"command":"%sql\nMERGE INTO f1_demo.drivers_merge tgt\nUSING drivers_day1 upd\nON tgt.driverId = upd.driverId\nWHEN MATCHED THEN\n  UPDATE SET tgt.dob = upd.dob,\n             tgt.forename = upd.forename,\n             tgt.surname = upd.surname,\n             tgt.updatedDate = current_timestamp\nWHEN NOT MATCHED\n  THEN INSERT (driverId, dob, forename,surname,createdDate ) VALUES (driverId, dob, forename,surname, current_timestamp)","commandVersion":65,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"622477b9-0e6e-4c45-91f0-2983678cbe72"},{"version":"CommandV1","origId":4277921907350497,"guid":"06186377-f9e8-4aa9-b038-d59c2c80fc44","subtype":"command","commandType":"auto","position":37.0,"command":"%sql SELECT * FROM f1_demo.drivers_merge;","commandVersion":5,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"700","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ba729701-1d9c-4443-ae41-afc0473d010f"},{"version":"CommandV1","origId":4277921907350498,"guid":"d5eb3485-a57a-4d95-9516-811311d2c508","subtype":"command","commandType":"auto","position":38.0,"command":"%md\nDay 2","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4e90cc76-18a0-44ea-aa68-6e0d90ca7835"},{"version":"CommandV1","origId":4277921907350499,"guid":"94cfffb7-fea5-4f9f-b82d-5b9ab7b7f209","subtype":"command","commandType":"auto","position":39.0,"command":"%sql\nMERGE INTO f1_demo.drivers_merge tgt\nUSING drivers_day2 upd\nON tgt.driverId = upd.driverId\nWHEN MATCHED THEN\n  UPDATE SET tgt.dob = upd.dob,\n             tgt.forename = upd.forename,\n             tgt.surname = upd.surname,\n             tgt.updatedDate = current_timestamp\nWHEN NOT MATCHED\n  THEN INSERT (driverId, dob, forename,surname,createdDate ) VALUES (driverId, dob, forename,surname, current_timestamp)","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0aec1ec5-d9ad-4fa9-b81c-c407cdf0539c"},{"version":"CommandV1","origId":4277921907350500,"guid":"1a734b81-25cd-4c39-8ab5-91e46dcf5042","subtype":"command","commandType":"auto","position":40.0,"command":"%sql SELECT * FROM f1_demo.drivers_merge;","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"707","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a8d97194-5295-48df-85ff-e85600903ed0"},{"version":"CommandV1","origId":4277921907350501,"guid":"5851d669-bd6b-464e-9d13-33c0a8cbb314","subtype":"command","commandType":"auto","position":40.5,"command":"%md\nDay 3","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"11e521be-ed9a-4e44-b48c-c5b72132c9dd"},{"version":"CommandV1","origId":4277921907350502,"guid":"0ca3ab2c-1f22-435f-b1ab-32ea88334704","subtype":"command","commandType":"auto","position":41.0,"command":"from pyspark.sql.functions import current_timestamp\nfrom delta.tables import DeltaTable\n\ndeltaTable = DeltaTable.forPath(spark, \"/mnt/formula1dl/demo/drivers_merge\")\n\ndeltaTable.alias(\"tgt\").merge(\n    drivers_day3_df.alias(\"upd\"),\n    \"tgt.driverId = upd.driverId\") \\\n  .whenMatchedUpdate(set = { \"dob\" : \"upd.dob\", \"forename\" : \"upd.forename\", \"surname\" : \"upd.surname\", \"updatedDate\": \"current_timestamp()\" } ) \\\n  .whenNotMatchedInsert(values =\n    {\n      \"driverId\": \"upd.driverId\",\n      \"dob\": \"upd.dob\",\n      \"forename\" : \"upd.forename\", \n      \"surname\" : \"upd.surname\", \n      \"createdDate\": \"current_timestamp()\"\n    }\n  ) \\\n  .execute()","commandVersion":81,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"30d1d932-93db-47f8-9fb2-4a8d08e4d2d6"},{"version":"CommandV1","origId":4277921907350503,"guid":"20be9dc4-d224-442c-9f32-f8691e6af69e","subtype":"command","commandType":"auto","position":42.0,"command":"%sql SELECT * FROM f1_demo.drivers_merge;","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"708","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"590d5748-6760-41af-a861-d52acdf5009f"},{"version":"CommandV1","origId":4277921907350504,"guid":"b58a9229-fe86-42ad-9379-012f1e999049","subtype":"command","commandType":"auto","position":43.0,"command":"%md\n1. History & Versioning\n2. Time Travel\n3. Vaccum","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4b8d47eb-2ce3-4fd5-933d-783def8241a7"},{"version":"CommandV1","origId":4277921907350505,"guid":"e5a1b723-9dd8-4453-af92-e5abfe224e40","subtype":"command","commandType":"auto","position":44.0,"command":"%sql\nDESC HISTORY f1_demo.drivers_merge","commandVersion":17,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3349","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3990e123-af44-4ca6-8deb-33c8708d6a27"},{"version":"CommandV1","origId":4277921907350506,"guid":"89a9ebd4-2b5b-4d49-adaa-03c429fa3173","subtype":"command","commandType":"auto","position":45.0,"command":"%sql\nSELECT * FROM f1_demo.drivers_merge VERSION AS OF 2;","commandVersion":12,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"707","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"93732c7f-0fea-4c83-8630-c72f42d7b024"},{"version":"CommandV1","origId":4277921907350507,"guid":"fc7825de-a728-4169-b466-03fd36abc260","subtype":"command","commandType":"auto","position":46.0,"command":"%sql\nSELECT * FROM f1_demo.drivers_merge TIMESTAMP AS OF '2021-06-23T15:40:33.000+0000';","commandVersion":7,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"700","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2258e9e3-3a26-4d0a-821e-25a0f18a9954"},{"version":"CommandV1","origId":4277921907350508,"guid":"758cdf4d-15fe-4d4c-bbe2-ec8057de789b","subtype":"command","commandType":"auto","position":47.0,"command":"df = spark.read.format(\"delta\").option(\"timestampAsOf\", '2021-06-23T15:40:33.000+0000').load(\"/mnt/formula1dl/demo/drivers_merge\")","commandVersion":30,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2c9a0e2b-8183-4937-a78a-116cc45a7d35"},{"version":"CommandV1","origId":4277921907350509,"guid":"5df0aa38-d38c-46a4-88b9-57a39f6b9b7d","subtype":"command","commandType":"auto","position":48.0,"command":"display(df)","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"700","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f310670b-e667-4ef5-ae6e-5047cfc7b859"},{"version":"CommandV1","origId":4277921907350510,"guid":"0fe4e44a-7718-4bb5-a4e0-cdbbb48a8c38","subtype":"command","commandType":"auto","position":49.0,"command":"%sql\nVACUUM f1_demo.drivers_merge","commandVersion":10,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"357","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"69705ae4-ba1e-4c68-8e1e-d8009bf1e556"},{"version":"CommandV1","origId":4277921907350511,"guid":"0e62e172-9e2a-4651-aa87-be23e8da640a","subtype":"command","commandType":"auto","position":50.0,"command":"%sql\nSELECT * FROM f1_demo.drivers_merge TIMESTAMP AS OF '2021-06-23T15:40:33.000+0000';","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"700","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a74649aa-9b62-4ebb-a095-b2d81d4d1b26"},{"version":"CommandV1","origId":4277921907350512,"guid":"9eb38db2-fbaa-4992-91ee-6ef153490bde","subtype":"command","commandType":"auto","position":51.0,"command":"%sql\nSET spark.databricks.delta.retentionDurationCheck.enabled = false;\nVACUUM f1_demo.drivers_merge RETAIN 0 HOURS","commandVersion":9,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"357","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5f6be23a-244f-4591-9328-857c4fb24d9b"},{"version":"CommandV1","origId":4277921907350513,"guid":"fb05859d-daec-4d67-b881-a858942e728b","subtype":"command","commandType":"auto","position":52.0,"command":"%sql\nSELECT * FROM f1_demo.drivers_merge TIMESTAMP AS OF '2021-06-23T15:40:33.000+0000';","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"41e65f92-c448-466d-bcb0-f67f9a25b1b1"},{"version":"CommandV1","origId":4277921907350514,"guid":"9ab8f5e4-e348-42b3-aa44-7af5150ec515","subtype":"command","commandType":"auto","position":53.0,"command":"%sql\nSELECT * FROM f1_demo.drivers_merge","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"708","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"163184bc-ce83-4f66-bdd6-d1966d29728a"},{"version":"CommandV1","origId":4277921907350515,"guid":"75d94e2a-ab35-434a-a44a-4a9b55c9ba32","subtype":"command","commandType":"auto","position":54.0,"command":"%sql\nDESC HISTORY f1_demo.drivers_merge;","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3349","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"613ffcdf-6bda-4651-9fbd-a84f5dd11f2d"},{"version":"CommandV1","origId":4277921907350516,"guid":"2fa35468-612b-4ab6-b259-958431eeb4a2","subtype":"command","commandType":"auto","position":55.0,"command":"%sql\nDELETE FROM f1_demo.drivers_merge WHERE driverId = 1;","commandVersion":20,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1b81299c-bba9-483a-80a4-bdd019787507"},{"version":"CommandV1","origId":4277921907350517,"guid":"2a342173-c12d-40b0-8347-4d80100e989a","subtype":"command","commandType":"auto","position":56.0,"command":"%sql \nSELECT * FROM f1_demo.drivers_merge VERSION AS OF 3;","commandVersion":11,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"708","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"debc0e59-3882-4d89-90d8-6f8cbf4d56cc"},{"version":"CommandV1","origId":4277921907350518,"guid":"dd09d463-c54d-4233-8935-30f2ff9135ba","subtype":"command","commandType":"auto","position":58.0,"command":"%sql\nMERGE INTO f1_demo.drivers_merge tgt\nUSING f1_demo.drivers_merge VERSION AS OF 3 src\n   ON (tgt.driverId = src.driverId)\nWHEN NOT MATCHED THEN\n   INSERT *","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4320fc9e-8fb3-48c1-a854-fa960bdeba85"},{"version":"CommandV1","origId":4277921907350519,"guid":"8aba53e7-9577-4a0a-81d4-7801a2006be3","subtype":"command","commandType":"auto","position":59.0,"command":"%sql DESC HISTORY f1_demo.drivers_merge","commandVersion":4,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3349","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5f06fba8-8e9c-4c8e-a804-ef19bc346e49"},{"version":"CommandV1","origId":4277921907350520,"guid":"c64221b5-b646-4680-92ab-929451372f33","subtype":"command","commandType":"auto","position":60.0,"command":"%sql\nSELECT * FROM f1_demo.drivers_merge","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"708","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"76a1ea66-b199-4f25-91b1-dad977a91aa8"},{"version":"CommandV1","origId":4277921907350521,"guid":"1f9a592d-f853-41ec-b5f7-46bc60007867","subtype":"command","commandType":"auto","position":61.0,"command":"%md\nTransaction Logs","commandVersion":7,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"913509bc-485a-48b2-8156-45050ca25233"},{"version":"CommandV1","origId":4277921907350522,"guid":"dac4aa6a-8335-45e7-860b-f6a9edd27c76","subtype":"command","commandType":"auto","position":62.0,"command":"%sql\nCREATE TABLE IF NOT EXISTS f1_demo.drivers_txn (\ndriverId INT,\ndob DATE,\nforename STRING, \nsurname STRING,\ncreatedDate DATE, \nupdatedDate DATE\n)\nUSING DELTA","commandVersion":3,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d22237bd-bc6f-4da8-b132-302d106afa07"},{"version":"CommandV1","origId":4277921907350523,"guid":"458d3cbd-0547-42f4-8525-e03f7abb98bc","subtype":"command","commandType":"auto","position":63.0,"command":"%sql\nDESC HISTORY f1_demo.drivers_txn","commandVersion":8,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2457","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c50f8a24-4099-41df-9d72-d5b6cf74ee20"},{"version":"CommandV1","origId":4277921907350524,"guid":"0e83a434-ff1c-42d2-b56d-4509192907d6","subtype":"command","commandType":"auto","position":64.0,"command":"%sql\nINSERT INTO f1_demo.drivers_txn\nSELECT * FROM f1_demo.drivers_merge\nWHERE driverId = 1;","commandVersion":20,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5ad234b8-237a-4067-ae96-a21508c2e1eb"},{"version":"CommandV1","origId":4277921907350525,"guid":"612b53fc-4a4e-4460-a8e2-3ac2bd644bf1","subtype":"command","commandType":"auto","position":65.0,"command":"%sql\nDESC HISTORY f1_demo.drivers_txn","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2744","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f3e5ddc5-7ade-491f-b188-be36854c9bf7"},{"version":"CommandV1","origId":4277921907350526,"guid":"23c30485-ed4d-4438-ade1-6c560b4e54f6","subtype":"command","commandType":"auto","position":66.0,"command":"%sql\nINSERT INTO f1_demo.drivers_txn\nSELECT * FROM f1_demo.drivers_merge\nWHERE driverId = 2;","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fd77a02a-4235-4049-bae4-459d90fbe0ae"},{"version":"CommandV1","origId":4277921907350527,"guid":"e7d69bfb-4443-4c54-bd75-970e37beb7e4","subtype":"command","commandType":"auto","position":67.0,"command":"%sql\nDELETE FROM  f1_demo.drivers_txn\nWHERE driverId = 1;","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e3362013-0e0c-4f41-8097-da0e4af6dd8e"},{"version":"CommandV1","origId":4277921907350528,"guid":"d3789260-5dea-4473-81ac-1475fa99e63e","subtype":"command","commandType":"auto","position":70.0,"command":"for driver_id in range(3, 20):\n  spark.sql(f\"\"\"INSERT INTO f1_demo.drivers_txn\n                SELECT * FROM f1_demo.drivers_merge\n                WHERE driverId = {driver_id}\"\"\")","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5806c21a-bb72-4e91-bab7-dd1ad8e4d93b"},{"version":"CommandV1","origId":4277921907350529,"guid":"99176762-6cd1-40d1-a8db-e9cf1aa056ed","subtype":"command","commandType":"auto","position":71.0,"command":"%sql\nINSERT INTO f1_demo.drivers_txn\nSELECT * FROM f1_demo.drivers_merge;","commandVersion":2,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"714f8c76-e8ca-453d-82c5-d3d84082f2b6"},{"version":"CommandV1","origId":4277921907350530,"guid":"20343fbe-2317-4246-90e7-4355052e6c91","subtype":"command","commandType":"auto","position":72.0,"command":"%md\nConvert Parquet to Delta","commandVersion":11,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"46e50ebd-8782-4988-9543-eea186db4dc6"},{"version":"CommandV1","origId":4277921907350531,"guid":"8a577dc0-7fe6-4b4f-81af-18e230a706c1","subtype":"command","commandType":"auto","position":73.0,"command":"%sql\nCREATE TABLE IF NOT EXISTS f1_demo.drivers_convert_to_delta (\ndriverId INT,\ndob DATE,\nforename STRING, \nsurname STRING,\ncreatedDate DATE, \nupdatedDate DATE\n)\nUSING PARQUET","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c86c7228-0fc6-47ec-b793-922f7647cd77"},{"version":"CommandV1","origId":4277921907350532,"guid":"57d53591-478b-4e6a-a68c-6c0e0dccb14e","subtype":"command","commandType":"auto","position":74.0,"command":"%sql\nINSERT INTO f1_demo.drivers_convert_to_delta\nSELECT * FROM f1_demo.drivers_merge","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b2d9d4d5-7b21-482c-b4c8-ee8ef8866754"},{"version":"CommandV1","origId":4277921907350533,"guid":"58732947-77a1-4bf0-b440-52e76a593112","subtype":"command","commandType":"auto","position":76.0,"command":"%sql\nCONVERT TO DELTA f1_demo.drivers_convert_to_delta","commandVersion":6,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9bdffa29-5038-49d6-9220-8e7ac6e20549"},{"version":"CommandV1","origId":4277921907350534,"guid":"5ce0e903-5dc8-45f3-80c0-09a4b0a8841d","subtype":"command","commandType":"auto","position":77.0,"command":"df = spark.table(\"f1_demo.drivers_convert_to_delta\")","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"61adb275-b7b6-43b4-ac85-5d33b4d2fedf"},{"version":"CommandV1","origId":4277921907350535,"guid":"1aa9728b-2164-4a02-84f0-ab5efabd5b30","subtype":"command","commandType":"auto","position":78.0,"command":"df.write.format(\"parquet\").save(\"/mnt/formula1dl/demo/drivers_convert_to_delta_new\")","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8ed9d3e9-9814-4745-82fa-dccf87a97653"},{"version":"CommandV1","origId":4277921907350536,"guid":"1711a2f6-6e6c-44d1-b5b5-28b2b7051f52","subtype":"command","commandType":"auto","position":79.0,"command":"%sql\nCONVERT TO DELTA parquet.`/mnt/formula1dl/demo/drivers_convert_to_delta_new`","commandVersion":14,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"da979a87-9b60-4236-9349-0e054cbe6757"},{"version":"CommandV1","origId":4277921907350537,"guid":"c7fba151-7a57-4fd8-9806-c9fd771e972f","subtype":"command","commandType":"auto","position":80.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b4d16b76-6c3c-4689-9247-fae223573389"}],"dashboards":[],"guid":"75eddb0d-c9a7-450b-8e4b-e527e3950bd6","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}
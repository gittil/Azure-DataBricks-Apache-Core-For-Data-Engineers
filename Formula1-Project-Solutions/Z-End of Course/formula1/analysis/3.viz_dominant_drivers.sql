{"version":"NotebookV1","origId":4277921907351719,"name":"3.viz_dominant_drivers","language":"sql","commands":[{"version":"CommandV1","origId":4277921907351720,"guid":"eb0359a3-f997-4dea-a39b-acbb6df3b13e","subtype":"command","commandType":"auto","position":1.5,"command":"%python\nhtml = \"\"\"<h1 style=\"color:Black;text-align:center;font-family:Ariel\">Dominant Formula 1 Drivers of All Time</h1>\"\"\"\ndisplayHTML(html)","commandVersion":28,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b6c7c3db-e341-42e0-a937-79f7265d9f07"},{"version":"CommandV1","origId":4277921907351721,"guid":"196a46c4-5532-47a3-bd7f-ce59ffd6ceb9","subtype":"command","commandType":"auto","position":3.0,"command":"CREATE OR REPLACE TEMP VIEW v_dominant_drivers\nAS\nSELECT driver_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points,\n       RANK() OVER(ORDER BY AVG(calculated_points) DESC) driver_rank\n  FROM f1_presentation.calculated_race_results\nGROUP BY driver_name\nHAVING COUNT(1) >= 50\nORDER BY avg_points DESC","commandVersion":64,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"707","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d09b44f1-0570-489d-a4bb-aee2b47fa29b"},{"version":"CommandV1","origId":4277921907351722,"guid":"70a83567-bd2b-41d3-92d1-52ff3ab092c5","subtype":"command","commandType":"auto","position":4.0,"command":"SELECT race_year, \n       driver_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points\n  FROM f1_presentation.calculated_race_results\n WHERE driver_name IN (SELECT driver_name FROM v_dominant_drivers WHERE driver_rank <= 10)\nGROUP BY race_year, driver_name\nORDER BY race_year, avg_points DESC","commandVersion":54,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"plotlyLine","width":"660","height":"auto","xColumns":["race_year"],"yColumns":["avg_points"],"pivotColumns":["driver_name"],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"plotlyLine":[{"key":"yRange","value":""},{"key":"showPoints","value":false},{"key":"logScale","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ebae419c-35e9-44dd-8d7d-46c60622c949"},{"version":"CommandV1","origId":4277921907351723,"guid":"6ce3a2cd-79af-47d2-8381-1f35c378176b","subtype":"command","commandType":"auto","position":5.0,"command":"SELECT race_year, \n       driver_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points\n  FROM f1_presentation.calculated_race_results\n WHERE driver_name IN (SELECT driver_name FROM v_dominant_drivers WHERE driver_rank <= 10)\nGROUP BY race_year, driver_name\nORDER BY race_year, avg_points DESC","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"plotlyBar","width":"660","height":"auto","xColumns":["driver_name"],"yColumns":["total_races","total_points"],"pivotColumns":[],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"plotlyBar":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c39988f0-9169-4b5d-9cba-14a4a10a779c"},{"version":"CommandV1","origId":4277921907351724,"guid":"0594b466-e02d-49cb-a8ef-21795689f71e","subtype":"command","commandType":"auto","position":6.0,"command":"SELECT race_year, \n       driver_name,\n       COUNT(1) AS total_races,\n       SUM(calculated_points) AS total_points,\n       AVG(calculated_points) AS avg_points\n  FROM f1_presentation.calculated_race_results\n WHERE driver_name IN (SELECT driver_name FROM v_dominant_drivers WHERE driver_rank <= 10)\nGROUP BY race_year, driver_name\nORDER BY race_year, avg_points DESC","commandVersion":1,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"areaChart","width":"660","height":"auto","xColumns":["race_year"],"yColumns":["avg_points"],"pivotColumns":["driver_name"],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c0dae90a-8e4e-47e9-a12c-d7cfa8277aa0"},{"version":"CommandV1","origId":4277921907351725,"guid":"6fc57d9f-6c05-4114-9ddd-4eeb95f4c779","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9bd1dfaf-2e3c-4941-ba7a-79dc30556f9f"}],"dashboards":[{"version":"DashboardViewV1","origId":4277921907351726,"guid":"b4677143-a6b4-4b63-b7b2-fa8235895187","nuid":"24b1ad96-ddc7-46c8-992f-3dd6d85fbbb7","title":"F1 Dominant Drivers","width":1024,"layoutOption":{"stack":true,"grid":true},"elements":[{"guid":"88561cbc-201e-40c6-99a6-3c6282c5041d","elementType":"command","elementNUID":"b6c7c3db-e341-42e0-a937-79f7265d9f07","position":{"width":24,"height":2,"x":0,"y":0,"z":null},"options":null},{"guid":"91c1cac5-16e5-4377-9918-a38b4d6a469b","elementType":"command","elementNUID":"ebae419c-35e9-44dd-8d7d-46c60622c949","position":{"width":12,"height":10,"x":0,"y":2,"z":null},"options":{"showTitle":false,"showRunButton":true,"scale":0,"autoScaleImg":false,"title":"Dominant Drivers","titleAlign":"center"}},{"guid":"fca30f46-5e41-4dbf-b0be-385729ffd881","elementType":"command","elementNUID":"c0dae90a-8e4e-47e9-a12c-d7cfa8277aa0","position":{"width":12,"height":10,"x":12,"y":2,"z":null},"options":{"showTitle":false,"showRunButton":true,"scale":0,"autoScaleImg":false,"title":"Dominant Drivers","titleAlign":"center"}}],"globalVars":{}}],"guid":"12138ed3-c611-466c-91d6-a68f31fdc607","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}